---
title: "Integration benchmarking"
author: "Carla Cohen"
date: "`r Sys.Date()`"
output: html_document
---

Comparision of lisi scores from integrations  

iLISI score should be as high as the expected number of clusters. 

cLISI should be as close to 1 as possible.  


Dataset	Integration method	iLISI	cLISI
Full	Merge	2.507	1.906
Full	Harmony	2.834	1.196
Full	scVI	3.542	1.018
No muscle	Merge	2.612	1.884
No muscle	Harmony	2.863	1.197
No muscle	scVI	3.652	1.017
No muscle/MSK1284       scvI        3.301 1.015

```{r}
df <- data.frame("Dataset" = c("Full", "Full", "Full", "No muscle", "No muscle", "No muscle", "No muscle or MSK1284"),
                 "Integration method" = c("Merge", "Harmony", "scVI", "Merge", "Harmony", "scVI", "scVI"), 
                 "iLISI" = c(2.507, 2.834, 3.542, 2.612, 2.863, 3.652, 3.301),
                 "cLISI" = c(1.906, 1.196, 1.018, 1.884, 1.197, 1.017, 1.015))

df

```


```{r}
ggplot(df, aes(x = iLISI, y = cLISI))+
    geom_point(aes(colour = Integration.method, shape = Dataset), size = 5)+
    theme_classic()
```


Next compare parameters for Harmony integration
Harmony-1 soupX filter and remove MSK1284
Harmony-2 remove MSK1284 only

Dataset	Integration method	iLISI	cLISI
Full	Merge	2.507	1.906
Full	Harmony	2.834	1.196
Full	Harmony-1       2.816       1.184	
Full    Harmony-2       2.811       1.191



```{r}
df <- data.frame("Dataset" = c("Full", "Full", "Full", "Full"),
                 "Integration method" = c("Merge", "Harmony", "Harmony-1", "Harmony-2"), 
                 "iLISI" = c(2.507, 2.834, 2.816, 2.811),
                 "cLISI" = c(1.906, 1.196, 1.184, 1.191))

df

```

```{r}
ggplot(df, aes(x = iLISI, y = cLISI))+
    geom_point(aes(colour = Integration.method), size = 5)+
    theme_classic()
```